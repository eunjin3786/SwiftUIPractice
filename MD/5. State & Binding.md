# State & Binding

## 1. State

ì´ ì½”ë“œëŠ” ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤.

```swift
struct ContentView: View {
    var buttonState = false
    
    var body: some View {
        Button(action: {
            self.buttonState.toggle()
        }, label: {
            Text("ë²„íŠ¼")
        })
    }
}
```



í•˜ì§€ë§Œ `buttonState` ì—  `@State` ë¥¼ ë¶™ì´ë©´ ì»´íŒŒì¼ ì—ëŸ¬ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.

```swift
struct ContentView: View {
    @State var buttonState = false
    
    var body: some View {
        Button(action: {
            self.buttonState.toggle()
        }, label: {
            Text("ë²„íŠ¼")
        })
    }
}
```



ê·¸ëŸ¼ Stateë€ ë¬´ì—‡ì¼ê¹Œìš”?!

ê°„ë‹¨íˆ ë§í•˜ìë©´ SwiftUIëŠ” 

**Stateê°€ ë°”ë€Œë©´ Viewë¥¼ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤. (ì¦‰ bodyë¥¼ ë‹¤ì‹œ ê·¸ë¦½ë‹ˆë‹¤.)**



> bodyí”„ë¡œí¼í‹°ë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•˜ê²Œ ë˜ì§€ë§Œ, ëª¨ë“  ê²ƒì„ ë‹¤ì‹œ ê·¸ë¦¬ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë·° ê³„ì¸µ êµ¬ì¡°ë¥¼ ë”°ë¼ ë‚´ë ¤ê°€ë©´ì„œ
>
> @Stateë¥¼ ì†Œìœ í•œ ë·°ë¥¼ ë¹„êµí•˜ê³  ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ì—¬ ë³€ê²½ëœ ë¶€ë¶„ë§Œ ë‹¤ì‹œ ë Œë”ë§í•˜ê¸° ë•Œë¬¸ì— ë§¤ìš° íš¨ìœ¨ì ìœ¼ë¡œ
>
> ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. - ìŠ¤ìœ—í•œ SwiftUI



ì•„ë˜ ì˜ˆì œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.

ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ nameì´ë¼ëŠ” stateë¥¼ ë°”ê¿”ì¤ë‹ˆë‹¤.

stateì˜ ë³€í™”ê°€ ìˆì„ ë•Œë§ˆë‹¤ bodyê°€ ë‹¤ì‹œ ê·¸ë ¤ì§€ê²Œ ë©ë‹ˆë‹¤.

```swift
struct ContentView: View {
    @State var name = ""
    
    var body: some View {
        VStack(spacing: 50) {
            Text(name)
                .font(.largeTitle)
                .fontWeight(.bold)
            
            VStack(spacing: 20) {
                Button(action: {
                    self.name = "ìœŒë¦¬ì—„"
                }, label: {
                    Text("ìœŒë¦¬ì—„ìœ¼ë¡œ ì´ë¦„ ë°”ê¾¸ëŠ” ë²„íŠ¼")
                })
                
                Button(action: {
                    self.name = "ë²¤í‹€ë¦¬"
                }, label: {
                    Text("ë²¤í‹€ë¦¬ë¡œ ì´ë¦„ ë°”ê¾¸ëŠ” ë²„íŠ¼")
                })
            }
        }
    }
}
```



![3xj4ga](https://user-images.githubusercontent.com/9502063/79884705-71288900-8430-11ea-95c6-fe28537cb70d.gif)











ê¸°ì¡´ì— ì˜ˆì œë¡œ ë§Œë“¤ì—ˆë˜ Listì½”ë“œì—ë„ `@State` ë¥¼ ì¶”ê°€í•´ë³´ê² ìŠµë‹ˆë‹¤.

```swift
struct ContentView: View {
    @State var friends: [Friend] = [Friend(name: "ìœŒë¦¬ì—„", profileImageName: "baby"),
                                    Friend(name: "ìœŒë¦¬ì—„", profileImageName: "baby"),
                                    Friend(name: "ìœŒë¦¬ì—„", profileImageName: "baby")]

    var body: some View {
        NavigationView {
            List(friends) { friend in
                NavigationLink(destination: FriendDetailGridView(friend: friend)) {
                    FriendCell(friend: friend)
                }
            }
            .navigationBarTitle("ë¦¬ìŠ¤íŠ¸")
            .navigationBarItems(leading: navigationLeftBarItem,
                                trailing: navigationRightBarItem)
        }
    }
    
    var navigationLeftBarItem: some View {
        Button(action: {
            self.friends.removeLast()
        }) {
            Text("-").font(.largeTitle)
        }
    }
    
    var navigationRightBarItem: some View {
        Button(action: {
            let friend = Friend(name: "ìœŒë¦¬ì—„", profileImageName: "baby")
            self.friends.append(friend)
        }) {
            Text("+").font(.largeTitle)
        }
    }
}
```



`@State` ë¥¼ ë¶™ì¸ ë³€ìˆ˜ê°€ ì—…ë°ì´íŠ¸ë˜ë©´ ë·°ê°€ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤ ğŸ‘



![3xjdjg](https://user-images.githubusercontent.com/9502063/79888586-df247e80-8437-11ea-9461-8518f992a5a7.gif)



## 2. Binding

### 2.1 Bindind Direction

ë‘ê°€ì§€ ë°©í–¥ì˜ ë°”ì¸ë”©ì´ ìˆìŠµë‹ˆë‹¤.

- View to ViewModel

- ViewModel to View



> ì•„ë˜ ì´ë¯¸ì§€ì˜ ì¶œì²˜ëŠ” https://www.udemy.com/course/swiftui-declarative-interfaces-for-any-apple-device/learn/lecture/15718004#overview ì…ë‹ˆë‹¤.



##### 1) View to ViewModel



<img width="674" alt="ìŠ¤í¬ë¦°ìƒ· 2020-04-29 ì˜¤í›„ 1 29 40" src="https://user-images.githubusercontent.com/9502063/80560869-7b90e700-8a1d-11ea-9eb0-78dacfb7f609.png">



Viewì˜ í…ìŠ¤íŠ¸í•„ë“œì— nameê³¼ ageë¥¼ ì…ë ¥í•˜ë©´ ViewModelì˜ nameê³¼ age í”„ë¡œí¼í‹°ê°€ ì—…ë°ì´íŠ¸ ë©ë‹ˆë‹¤.



##### 2) ViewModel to View



<img width="697" alt="ìŠ¤í¬ë¦°ìƒ· 2020-04-29 ì˜¤í›„ 1 30 56" src="https://user-images.githubusercontent.com/9502063/80560925-aa0ec200-8a1d-11ea-8831-62ed8885c910.png">



ViewModelì˜ nameê³¼ age í”„ë¡œí¼í‹°ê°€ ì—…ë°ì´íŠ¸ë˜ë©´ ë·°ì˜ í…ìŠ¤íŠ¸í•„ë“œì˜ í…ìŠ¤íŠ¸ê°€ ì—…ë°ì´íŠ¸ ë©ë‹ˆë‹¤. 



### 2.2 ì˜ˆì œ - TextField



`TextField` ë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.

`TextField`ì˜ ì´ë‹ˆì…œë¼ì´ì €ëŠ” ì´ë ‡ê²Œ ìƒê²¼ëŠ”ë°ìš”, 

```swift
init<S>(_ title: S, text: Binding<String>, onEditingChanged: @escaping (Bool) -> Void = { _ in }, onCommit: @escaping () -> Void = {}) where S : StringProtocol
```



ì¼ë‹¨ titleì— placeholderë¥¼ ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.

ê·¸ë¦¬ê³  textëŠ” `Binding<String>` íƒ€ì…ì¸ ê²ƒì„ ìœ ì˜í•´ì£¼ì„¸ìš”-!



textì˜ íƒ€ì…ì— ë§ê²Œ state í”„ë¡œí¼í‹°ì— ë‹¬ëŸ¬($)ë¥¼ ë¶™ì—¬ì„œ ë„£ì–´ì¤¬ìŠµë‹ˆë‹¤.

[Bindingë¬¸ì„œ](https://developer.apple.com/documentation/swiftui/binding)ë¥¼ ë³´ë©´ 

$ prefixëŠ” state í”„ë¡œí¼í‹°ì˜  [`projectedValue`](https://developer.apple.com/documentation/swiftui/state/3351220-projectedvalue) propertyë¡œ ë¶€í„° ë°”ì¸ë”©ì„ retrieveí•´ì¤€ë‹¤(??) ë¼ê³  í•©ë‹ˆë‹¤.

(This retrieves a binding of the state property from its [`projectedValue`](https://developer.apple.com/documentation/swiftui/state/3351220-projectedvalue) property)



```swift
struct ContentView: View {
    @State private var name: String = ""
    var body: some View {
        VStack {
            TextField("Enter your name", text: $name)
            Spacer().frame(height: 30)
            Text(name)
        }
    }
}
```



ìœ„ì˜ ì˜ˆì œëŠ” two-way bindingì´ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- TextFieldì— textê°€ ì…ë ¥ë ë•Œë§ˆë‹¤ nameë³€ìˆ˜ë¥¼ ì—…ë°ì´íŠ¸ ì‹œí‚µë‹ˆë‹¤
- nameë³€ìˆ˜ê°€ ì—…ë°ì´íŠ¸ ë ë•Œë§ˆë‹¤ ë·°ê°€ ë‹¤ì‹œ ê·¸ë ¤ì§‘ë‹ˆë‹¤.



### 2.3 ì˜ˆì œ - Toggle

```swift
struct ContentView: View {
    @State private var showGreeting = true

    var body: some View {
        VStack {
            Toggle(isOn: $showGreeting) {
                Text("Show welcome message")
            }.padding()

            if showGreeting {
                Text("Hello World!")
            }
        }
    }
}

// https://www.hackingwithswift.com/quick-start/swiftui/how-to-create-a-toggle-switch
```



Toggleì˜ ì´ë‹ˆì…œë¼ì´ì €ëŠ” ì´ë ‡ê²Œ ìƒê²¼ìŠµë‹ˆë‹¤.

```swift
init(isOn: Binding<Bool>, @ViewBuilder label: () -> Label)
```

ê·¸ë˜ì„œ state propertyì— $ë¥¼ ë¶™ì—¬ì„œ ë„£ì–´ì¤¬ìŠµë‹ˆë‹¤.



`Toggle` ë„ two-way bindingì´ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- toggleì„ on/offë¡œ ë°”ê¿€ ë•Œë§ˆë‹¤ showGreetingë³€ìˆ˜ë¥¼ ì—…ë°ì´íŠ¸ ì‹œí‚µë‹ˆë‹¤.
- showGreetingë³€ìˆ˜ê°€ ì—…ë°ì´íŠ¸ë ë•Œë§ˆë‹¤ ë·°ê°€ ë‹¤ì‹œ ê·¸ë ¤ì§‘ë‹ˆë‹¤.



### 2.4 ì˜ˆì œ - Custom View

ìœ„ì˜ ì˜ˆì œì—ì„œ Binding<> íƒ€ì…ì„ í†µí•´ two-way bindingì„ í•œ ê²ƒ ì²˜ëŸ¼

custom viewë¥¼ ë§Œë“¤ë•Œë„ ì£¼ì…ë°›ì•„ì•¼í•˜ëŠ” í”„ë¡œí¼í‹°ì— @Bindingì„ ë¶™ì´ë©´ ë™ì¼í•œ íš¨ê³¼(?)ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



ì´ë ‡ê²Œ custom viewë¥¼ ë§Œë“¤ë©´,

```swift
struct PlayView: View {
    @Binding var isPlay: Bool
    
    var body: some View {
        Button(action: {
            self.isPlay.toggle()
        }) {
            Text(isPlay ? "â¹" : "â–¶ï¸")
                .font(.largeTitle)
        }
    }
}
```



ì‚¬ìš©í•˜ëŠ” ìª½ì—ì„œ ë°”ì¸ë”© íƒ€ì…ì˜ í”„ë¡œí¼í‹°ë¥¼ ë„£ì–´ì£¼ê²Œ ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.



<img width="497" alt="ìŠ¤í¬ë¦°ìƒ· 2020-04-29 ì˜¤í›„ 2 57 29" src="https://user-images.githubusercontent.com/9502063/80564782-c0bb1600-8a29-11ea-8594-b111377474df.png">





ì „ì²´ ì½”ë“œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.

```swift
struct ContentView: View {
    @State private var isPlay = false
    
    var body: some View {
        VStack {
            Text("ë…¸ë˜ì œëª©")
                .font(.largeTitle)
                .foregroundColor(isPlay ? .green : .gray)
            
            Spacer()
                .frame(height: 20)
            
            Text("ê°€ìˆ˜ì´ë¦„")
                .font(.title)
                .foregroundColor(isPlay ? .green : .gray)
            
            Spacer()
                .frame(height: 20)
            
            PlayView(isPlay: $isPlay)
        }
    }
}

struct PlayView: View {
    @Binding var isPlay: Bool
    
    var body: some View {
        Button(action: {
            self.isPlay.toggle()
        }) {
            Text(isPlay ? "â¹" : "â–¶ï¸")
                .font(.largeTitle)
        }
    }
}
```



1) `PlayView`ë¥¼ ë§Œë“¤ë•Œ,  `$isPlay` ë¥¼ ë„˜ê²¨ì¤¬ìŠµë‹ˆë‹¤.

2) `PlayView` ì˜ ë²„íŠ¼ì´ í´ë¦­ë ë•Œë§ˆë‹¤ `isPlay` ê°’ì„ ì—…ë°ì´íŠ¸ ì‹œí‚µë‹ˆë‹¤.

3) `isPlay` ê°’ì˜ ì—…ë°ì´íŠ¸ë ë•Œë§ˆë‹¤  `ContentView` ê°€ ë‹¤ì‹œ ê·¸ë ¤ì§‘ë‹ˆë‹¤.



![3yp6uy](https://user-images.githubusercontent.com/9502063/80565031-6bcbcf80-8a2a-11ea-94d7-d179117a8ba6.gif)



### 2.5 Single source of truth 

> ì•„ë˜ì˜ ì„¤ëª…ì€ ëª¨ë‘ "ìŠ¤ìœ—í•œ SwiftUI" ì±…ì—ì„œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤. ë„ˆë¬´ ì¢‹ì€ ì„¤ëª…ì´ë¼...!! ğŸ¥º
>
> í˜¹ì‹œ ë¬¸ì œê°€ ëœë‹¤ë©´ ë§ì”€í•´ì£¼ì„¸ìš”  



SwiftUIëŠ” ë°ì´í„°ë¥¼ í¬ê²Œ ì›ì²œ ìë£Œ(source of truth)ì™€ íŒŒìƒìë£Œ(derived value, derived data)ë¡œ êµ¬ë¶„í•©ë‹ˆë‹¤.

ì´ë¦„ì²˜ëŸ¼ ì›ì²œìë£ŒëŠ” ê·¸ ìì²´ê°€ ë³¸ì§ˆì ì¸ ë°ì´í„°ì´ê³  íŒŒìƒìë£ŒëŠ” ì›ì²œìë£Œë¡œ ë¶€í„° ë¶€ì°¨ì ìœ¼ë¡œ íŒŒìƒëœ ê²ƒì…ë‹ˆë‹¤.

ë‹¨ì¼ ì›ì²œ ìë£Œ(single source of truth)ëŠ” ë™ì¼í•œ ë°ì´í„°ìš”ì†Œê°€ ì—¬ëŸ¬ ê³³ìœ¼ë¡œ ë‚˜ë‰˜ì–´ ì¤‘ë³µë˜ì§€ ì•Šê³  í•œ ê³³ì—ì„œ ë‹¤ë£¨ì–´ì§€ê³  ìˆ˜ì •ë˜ì–´ì•¼í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. 



ì˜ˆë¥¼ë“¤ì–´ ë‘ ë·°ê°€ ê°™ì€ isFavoriteê°’ì„ ê°€ì ¸ì•¼í•œë‹¤ê³  í•´ë´…ì‹œë‹¤.



```swift
struct MainView: View {
  @State private let isFavorite: Bool = true
}

struct DetailView: View {
  @State private let isFavorite: Bool = true
}
```



ì´ ë•ŒëŠ” ìƒì„±ìë¥¼ í†µí•´ ê°’ì„ ë„˜ê²¨ì£¼ì—ˆë‹¤ í•˜ë”ë¼ë„ ë‘ ë·°ê°€ ê°ê° ê³ ìœ í•œ ê°’ì„ ê°€ì§€ë©°,

ê·¸ ê°’ì´ ì¤‘ê°„ì— ë³€ê²½ë  ìˆ˜ ìˆì–´ì„œ ë°ì´í„° ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

ì´ ë¬¸ì œë¥¼ í”¼í•˜ë ¤ë©´ ê°’ì´ ë³€í• ë•Œë§ˆë‹¤ ë³„ë„ì˜ ë™ê¸°í™” ì‘ì—…ì„ í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤. 



ê·¸ëŸ¼  `DetailView`ì—ì„œ ë³„ë„ì˜ ìƒíƒœë³€ìˆ˜ë¥¼ ë‘ì§€ ì•Šê³  `MainView`ê°€ ê°€ì§„ ë°ì´í„°ë¥¼ ì°¸ì¡°í•˜ë„ë¡ ìˆ˜ì •í•´ë³´ê² ìŠµë‹ˆë‹¤.

```swift
struct MainView: View {
  @State private let isFavorite: Bool = true
}

struct DetailView: View {
  @Binding var isFavorite: Bool
}
```



ì´ì œ ë‘ í™”ë©´ì˜ ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©° ë™ê¸°í™”ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ìˆ˜ê³ ë„ ëœ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¨ì¼ ì›ì²œ ìë£Œ(single source of truth) ë¥¼ ê°€ì§„ë‹¤ëŠ” ê²ƒì€ ì´ëŸ° ê°œë…ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.



`@State`ëŠ” ë·° ìì²´ì—ì„œ ê°€ì ¸ì•¼í•  ìƒíƒœ í”„ë¡œí¼í‹° & ì›ì²œ ìë£Œ(source of truth) ì…ë‹ˆë‹¤.

ìƒìœ„ë·°ê°€ ê°€ì§„ ìƒíƒœë¥¼ í•˜ìœ„ ë·°ì—ì„œ ì‚¬ìš©í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” íŒŒìƒìë£Œ(derived value, derived data)ì—ëŠ”

`@Binding`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.





## 3. ObservableObjectì™€ @ObservedObject

[SwiftUI - State and Data Flow](https://developer.apple.com/documentation/swiftui/state_and_data_flow) ë¬¸ì„œë¥¼ ë³´ë©´

Stateì™€ Binding ë¿ë§Œì•„ë‹ˆë¼ ObservableObject, EnvironmentObjectì— ëŒ€í•´ì„œë„ ë‚˜ì™€ìˆìŠµë‹ˆë‹¤.

3ë²ˆë¶€í„°ëŠ” ì´ ì¹œêµ¬ë“¤ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.



<img width="701" alt="ìŠ¤í¬ë¦°ìƒ· 2020-04-29 ì˜¤í›„ 3 49 08" src="https://user-images.githubusercontent.com/9502063/80567931-f9122280-8a30-11ea-916c-5f9070a79b34.png">



`@State` ê°€ ë·°ì˜ ìƒíƒœë¥¼ ì €ì¥í•˜ê³  ë‹¤ë£¨ê¸° ìœ„í•œ ì›ì²œ ìë£Œë¡œ ì´ìš©ë˜ì—ˆë‹¤ë©´,

ë·° ì™¸ë¶€ì˜ ëª¨ë¸ì´ ê°€ì§„ ì›ì²œ ìë£Œë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ ë„êµ¬ë„ ìˆìŠµë‹ˆë‹¤.

ë°”ë¡œ `ObservabableObject` ë¼ëŠ” í”„ë¡œí† ì½œ ì…ë‹ˆë‹¤.


(ì°¸ê³ ë¡œ ì´ í”„ë¡œí† ì½œì€ `AnyObject` ë¥¼ ì±„íƒí•˜ê³  ìˆì–´ì„œ êµ¬ì¡°ì²´ë‚˜ ì—´ê±°í˜• íƒ€ì…ì—ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.)



[ObservableObject](https://developer.apple.com/documentation/combine/observableobject) ëŠ” Combineì•ˆì— ìˆìœ¼ë¯€ë¡œ 

Combindeì„ importí•´ì£¼ê³  `ObservableObject` í”„ë¡œí† ì½œì„ ì±„íƒí•˜ëŠ” UserSettingsë¼ëŠ” ëª¨ë¸ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”

ê·¸ë¦¬ê³  í”„ë¡œí¼í‹°ì˜ ê°’ì´ ì—…ë°ì´íŠ¸ë ë•Œë§ˆë‹¤ ë·°ë¥¼ ì—…ë°ì´íŠ¸ ì‹œì¼œì¤˜ì•¼í•œë‹¤ë©´

ê·¸ í”„ë¡œí¼í‹°ì— `@Published` ë¥¼ ë¶™ì—¬ì£¼ì„¸ìš”.

(í”„ë¡œí¼í‹°ì— `@Published` ë¶™ì´ëŠ” ê²ƒì„ í•´ë‹¹ í”„ë¡œí¼í‹°ì˜ ê°’ì´ ë³€í• ë•Œë§ˆë‹¤ ì´ë²¤íŠ¸ë¥¼ publish í•˜ë„ë¡ ì„¸íŒ…í•´ì£¼ëŠ” ê²ƒìœ¼ë¡œ ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤)

scoreì—ë§Œ  `@Published` ë¥¼ ë¶™ì—¬ì¤˜ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```swift
import Foundation
import Combine

class UserSettings: ObservableObject {
    @Published var score: Int = 0
    var name: String = ""
}
```



ê·¸ë¦¬ê³  `ContentView` ë¥¼ ì´ë ‡ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”

userSettingsì— `@ObservedObject` ë¥¼ ë¶™ì—¬ì£¼ì„¸ìš”



```swift
struct ContentView: View {
    @ObservedObject var userSettings = UserSettings()
    
    var body: some View {
        VStack {
            Text("\(userSettings.score)")
                .font(.largeTitle)
            
            Text("\(userSettings.name)")
                .font(.largeTitle)
            
            Button("Increment Score") {
                self.userSettings.score += 1
            }
            
            Button("Change Name") {
                self.userSettings.name = (self.userSettings.score % 2 == 0) ? "ìœŒë¦¬ì—„" : "ë²¤í‹€ë¦¬"
                print(self.userSettings.name)
            }
        }
    }
}
```



`changeName` ë²„íŠ¼ì„ ëˆŒë €ì„ë•Œ  `userSettings.name` ì€ ì—…ë°ì´íŠ¸ ë˜ì§€ë§Œ (printë¬¸ìœ¼ë¡œ í™•ì¸í•´ë³´ë©´ ë°”ë€ ê°’ì´ ì°í™ë‹ˆë‹¤.)

ë·°ëŠ” ì•„ë¬´ ì—…ë°ì´íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.



ë°˜ë©´ `Increment Score` ë²„íŠ¼ì„ ëˆŒë €ì„ë•Œ, `score` ì„ ë³´ì—¬ì£¼ëŠ” ë·°ê°€ ì¦‰ê°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`@Published` ë¥¼ ë¶™ì˜€ì„ë•Œì™€ ì•ˆë¶™ì˜€ì„ë•Œì˜ ì°¨ì´ë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.



![3ypxbk](https://user-images.githubusercontent.com/9502063/80572579-793c8600-8a39-11ea-9cc7-1c3b9a51104d.gif)



## 4. EnvironmentObjectì™€ @EnvironmentObject

ìœ„ì˜ ì˜ˆì œì—ì„œ `Increment` ê´€ë ¨ ë²„íŠ¼ì„ ë‹¤ë¥¸ ë·°ë¡œ ë¹¼ê³  ì‹¶ì„ë•ŒëŠ”

ì•ì—ì„œ ì‚´í´ë³¸ `@Binding`ì„ ì¨ì•¼ê² ì£ ?! (ìœ„ì˜ ì˜ˆì œì—ì„œ nameì€ ë¹¼ê³  scoreë¡œë§Œ ì§„í–‰í• ê²Œìš”!)

```swift
class UserSettings: ObservableObject {
    @Published var score: Int = 0
}
```

```swift
struct ContentView: View {
    @ObservedObject var userSettings = UserSettings()
    
    var body: some View {
        VStack {
            Text("\(userSettings.score)")
                .font(.largeTitle)
            
            Text("\(userSettings.name)")
                .font(.largeTitle)
            
            IncreaseScoreButton(score: $userSettings.score)
        }
    }
}

struct IncreaseScoreButton: View {
    @Binding var score: Int
    
    var body: some View {
        Button("Increment Score") {
            self.score += 1
        }
    }
}
```



`@State` ë¥¼ ë¶™ì¸ í”„ë¡œí¼í‹°ì™€ ë™ì¼í•˜ê²Œ 

`@Published` ë¥¼ ë¶™ì¸ í”„ë¡œí¼í‹°ë„ $(ë‹¬ëŸ¬)ë¥¼ ì´ìš©í•˜ì—¬ `Binding` íƒ€ì…ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 



í•˜ì§€ë§Œ `userSettings`ë¥¼ ì£¼ì…í•´ì¤˜ì•¼í•˜ëŠ” ì—¬ëŸ¬ ìì‹ ë·°ë“¤ì´ ìˆë‹¤ê³  ê°€ì •í•´ë³¼ ë•Œ, í•˜ë‚˜ì”© ë‹¤ ì£¼ì…í•´ì£¼ëŠ” ê²ƒë§ê³ 

ëª¨ë“  ë·°ë“¤ì´ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” global stateë¥¼ ë§Œë“¤ê³  ì‹¶ì„ ê²ƒì…ë‹ˆë‹¤. 

ê·¸ëŸ´ ë•Œ, `EnvironmentObject` ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.



`sceneDelegate` ì—ì„œ ê°€ì„œ contentViewì— `environmentObject` ë¥¼ ì£¼ì…í•´ì£¼ì„¸ìš”

```swift
    func scene(_ scene: UIScene, willConnectTo session: UISceneSession, options connectionOptions: UIScene.ConnectionOptions) {
      
        // Create the SwiftUI view that provides the window contents.
        let userSettings = UserSettings()
        let contentView = ContentView().environmentObject(userSettings)

        // Use a UIHostingController as window root view controller.
        if let windowScene = scene as? UIWindowScene {
            let window = UIWindow(windowScene: windowScene)
            window.rootViewController = UIHostingController(rootView: contentView)
            self.window = window
            window.makeKeyAndVisible()
        }
    }
```



`ContentView` ì˜ userSettings í”„ë¡œí¼í‹° prefixë¥¼  `@EnvironmentObject` ë¡œ ë°”ê¿”ì£¼ì„¸ìš”

`IncreaseScoreButton` ë„ `userSettings`  ì„ ê°€ì§€ë„ë¡ ë°”ê¿”ì£¼ì„¸ìš”



```swift
struct ContentView: View {
    @EnvironmentObject var userSettings: UserSettings
    
    var body: some View {
        VStack {
            Text("\(userSettings.score)")
                .font(.largeTitle)

            IncreaseScoreButton()
        }
    }
}

struct IncreaseScoreButton: View {
    @EnvironmentObject var userSettings: UserSettings
    
    var body: some View {
        Button("Increment Score") {
            self.userSettings.score += 1
        }
    }
}
```



ë†€ëê²Œë„ IncreaseScoreButtonì˜ ì´ë‹ˆì…œë¼ì´ì €ë¡œ ì•„ë¬´ê²ƒë„ ì•ˆë„£ì–´ë„ ì»´íŒŒì¼ì—ëŸ¬ ì—†ì´ ì˜ ë™ì‘í•©ë‹ˆë‹¤. 

contentViewì˜ ëª¨ë“  childViewë“¤ì€ contentViewì˜ EnvironmentObjectì— ì ‘ê·¼ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ì¦‰ ë¶€ëª¨ ë·°ì˜ ëª¨ë“  subviewë“¤ì´ EnvironmnetObjectë¥¼ í†µí•´ ë¶€ëª¨ê°€ ê°€ì§€ê³  ìˆëŠ” ëª¨ë¸ì— ì ‘ê·¼í•˜ê²Œ ë  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤. </br></br></br>







ì°¸ê³ ë¡œ í”„ë¦¬ë·°ì—ì„œë„ ë¹Œë“œê°€ ì„±ê³µí•˜ê²Œ í•˜ë ¤ë©´ previewì½”ë“œì—ë„ environmentObjectë¥¼ ì£¼ì…í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.

```swift
struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        ContentView().environmentObject(UserSettings())
    }
}
```

